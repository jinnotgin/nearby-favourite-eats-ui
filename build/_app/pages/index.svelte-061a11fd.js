import{S as t,i as e,s as a,e as n,t as r,k as o,c as s,a as i,g as l,d as c,n as u,b as h,f as d,F as f,h as g,H as v,I as p,G as m,z as y,J as b}from"../chunks/vendor-e3850ccb.js";function E(t,e,a){const n=t.slice();return n[11]=e[a],n}function w(t,e,a){const n=t.slice();return n[14]=e[a],n}function M(t,e){let a,r;return{key:t,first:null,c(){a=n("img"),this.h()},l(t){a=s(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){a.src!==(r=e[14])&&h(a,"src",r),h(a,"alt","Restarurant or food"),h(a,"class","svelte-1gk4kst"),this.first=a},m(t,e){d(t,a,e)},p(t,n){e=t,3&n&&a.src!==(r=e[14])&&h(a,"src",r)},d(t){t&&c(a)}}}function k(t,e){let a,p,m,y,E,k,H,$,j,I,P,D,F,N,_,x=e[0][e[11]].name+"",R=e[0][e[11]].details+"",S=e[4](e[0][e[11]].openingHours)+"",T=[],U=new Map,G=e[0][e[11]].featuredImages;const O=t=>t[14];for(let n=0;n<G.length;n+=1){let t=w(e,G,n),a=O(t);U.set(a,T[n]=M(a,t))}return{key:t,first:null,c(){a=n("p"),p=n("strong"),m=r(x),y=o(),E=n("p"),k=n("a"),H=r(R),j=o(),I=n("p"),P=r(S),D=o(),F=n("div");for(let t=0;t<T.length;t+=1)T[t].c();N=o(),_=n("hr"),this.h()},l(t){a=s(t,"P",{});var e=i(a);p=s(e,"STRONG",{});var n=i(p);m=l(n,x),n.forEach(c),e.forEach(c),y=u(t),E=s(t,"P",{});var r=i(E);k=s(r,"A",{href:!0,target:!0});var o=i(k);H=l(o,R),o.forEach(c),r.forEach(c),j=u(t),I=s(t,"P",{});var h=i(I);P=l(h,S),h.forEach(c),D=u(t),F=s(t,"DIV",{class:!0});var d=i(F);for(let a=0;a<T.length;a+=1)T[a].l(d);d.forEach(c),N=u(t),_=s(t,"HR",{}),this.h()},h(){h(k,"href",$=e[0][e[11]].googleMapUrl),h(k,"target","_blank"),h(F,"class","images-container svelte-1gk4kst"),this.first=a},m(t,e){d(t,a,e),f(a,p),f(p,m),d(t,y,e),d(t,E,e),f(E,k),f(k,H),d(t,j,e),d(t,I,e),f(I,P),d(t,D,e),d(t,F,e);for(let a=0;a<T.length;a+=1)T[a].m(F,null);d(t,N,e),d(t,_,e)},p(t,a){e=t,3&a&&x!==(x=e[0][e[11]].name+"")&&g(m,x),3&a&&R!==(R=e[0][e[11]].details+"")&&g(H,R),3&a&&$!==($=e[0][e[11]].googleMapUrl)&&h(k,"href",$),3&a&&S!==(S=e[4](e[0][e[11]].openingHours)+"")&&g(P,S),3&a&&(G=e[0][e[11]].featuredImages,T=v(T,a,O,1,e,G,U,F,b,M,null,w))},d(t){t&&c(a),t&&c(y),t&&c(E),t&&c(j),t&&c(I),t&&c(D),t&&c(F);for(let e=0;e<T.length;e+=1)T[e].d();t&&c(N),t&&c(_)}}}function H(t){let e,a,h,y,w,M,H,$,j,I,P,D,F,N,_=[],x=new Map,R=t[1];const S=t=>t[11];for(let n=0;n<R.length;n+=1){let e=E(t,R,n),a=S(e);x.set(a,_[n]=k(a,e))}return{c(){e=o(),a=n("h1"),h=r("Nearby Fav Eats"),y=o(),w=n("h2"),M=r("Venues: "),H=r(t[3]),$=o(),j=n("hr"),I=o();for(let t=0;t<_.length;t+=1)_[t].c();P=o(),D=n("h3"),F=r("Last Updated: "),N=r(t[2]),this.h()},l(n){p('[data-svelte="svelte-1b6e0hl"]',document.head).forEach(c),e=u(n),a=s(n,"H1",{});var r=i(a);h=l(r,"Nearby Fav Eats"),r.forEach(c),y=u(n),w=s(n,"H2",{});var o=i(w);M=l(o,"Venues: "),H=l(o,t[3]),o.forEach(c),$=u(n),j=s(n,"HR",{}),I=u(n);for(let t=0;t<_.length;t+=1)_[t].l(n);P=u(n),D=s(n,"H3",{});var d=i(D);F=l(d,"Last Updated: "),N=l(d,t[2]),d.forEach(c),this.h()},h(){document.title="Nearby Favourite Eats"},m(t,n){d(t,e,n),d(t,a,n),f(a,h),d(t,y,n),d(t,w,n),f(w,M),f(w,H),d(t,$,n),d(t,j,n),d(t,I,n);for(let e=0;e<_.length;e+=1)_[e].m(t,n);d(t,P,n),d(t,D,n),f(D,F),f(D,N)},p(t,[e]){8&e&&g(H,t[3]),19&e&&(R=t[1],_=v(_,e,S,1,t,R,x,P.parentNode,b,k,P,E)),4&e&&g(N,t[2])},i:m,o:m,d(t){t&&c(e),t&&c(a),t&&c(y),t&&c(w),t&&c($),t&&c(j),t&&c(I);for(let e=0;e<_.length;e+=1)_[e].d(t);t&&c(P),t&&c(D)}}}function $(t,e,a){let n;var r=this&&this.__awaiter||function(t,e,a,n){return new(a||(a=Promise))((function(r,o){function s(t){try{l(n.next(t))}catch(e){o(e)}}function i(t){try{l(n.throw(t))}catch(e){o(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof a?e:new a((function(t){t(e)}))).then(s,i)}l((n=n.apply(t,e||[])).next())}))};let o,s={coords:{longitude:0,latitude:0}},i={},l=[];const c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][(new Date).getDay()],u={name:(t,e)=>t.name>e.name?1:t.name<e.name?-1:0,price(t,e){function a(t){var e=t&&t.match(/\d/g).join("")||0;return parseInt(e,10)}return a(t.formatted_price)-a(e.formatted_price)},nearby(t,e){function a(t,e){var a=Math.atan2,n=Math.cos,r=Math.sin,o=Math.sqrt,s=Math.PI;function i(t){return t*t}function l(t){return t*s/180}var c=t.latitude,u=e.latitude,h=t.longitude,d=e.longitude,f=l(u-c),g=l(d-h),v=i(r(f/2))+n(l(c))*n(l(u))*i(r(g/2));return 6378137*(2*a(o(v),o(1-v)))}var n={latitude:s.coords.latitude,longitude:s.coords.longitude};return a(n,t.location)-a(n,e.location)}};return y((()=>r(void 0,void 0,void 0,(function*(){const t=yield fetch(`https://raw.githubusercontent.com/jinnotgin/burpple-wishlist-scraper/main/data/venues.json?${(new Date).getTime()}`),e=yield t.json();var n;a(0,i=e.data),a(2,o=new Date(e.end)),a(5,s=yield(n={timeout:1e4},new Promise((function(t,e){navigator.geolocation.getCurrentPosition(t,e,n)}))))})))),t.$$.update=()=>{1&t.$$.dirty&&a(3,n=Object.keys(i).length),35&t.$$.dirty&&(a(1,l=Object.values(i).sort(u.nearby).map((t=>t.id))),console.log("sorted based on geolocation"),console.log(l))},[i,l,o,n,t=>t.includes(c)?t.split(`${c}:`)[1].split("\n")[0]:"",s]}export default class extends t{constructor(t){super(),e(this,t,$,H,a,{})}}
